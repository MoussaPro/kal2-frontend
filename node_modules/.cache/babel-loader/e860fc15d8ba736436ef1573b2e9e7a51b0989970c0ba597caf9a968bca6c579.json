{"ast":null,"code":"import { computed, onMounted, ref } from \"vue\";\nimport axios from \"axios\";\nimport DisplayField from \"@/components/DisplayField\";\nexport default {\n  __name: 'FieldsContainer',\n  props: {\n    jsonData: String\n  },\n  setup(__props, {\n    expose\n  }) {\n    expose();\n    const props = __props;\n    const apiData = ref();\n    const loading = ref();\n    const error = ref();\n    const activeField = ref();\n    const selectedFieldId = ref(null);\n    const toggleTemplates = ref();\n    const selectedField = computed(() => {\n      if (apiData.value) {\n        // If no selected field set the primary\n        if (selectedFieldId.value === null) {\n          const primaryField = apiData.value.filter(field => field.is_primary === 1)[0];\n          if (!primaryField) {\n            // If no primary, set the first one\n            activeField.value = apiData.value[0];\n            return apiData.value[0];\n          }\n          activeField.value = primaryField;\n          return primaryField;\n        } else {\n          // If selected field\n          activeField.value = apiData.value.filter(field => field.id === selectedFieldId.value)[0];\n          return apiData.value.filter(field => field.id === selectedFieldId.value)[0];\n        }\n      }\n    });\n    const hideToggleTemplates = () => {\n      if (toggleTemplates.value) {\n        toggleTemplates.value = false;\n      }\n    };\n    const setFieldId = field_id => {\n      selectedFieldId.value = field_id;\n      toggleTemplates.value = false; // Hide dropdown after selected\n    };\n\n    const updateField = (updatedField, field_id) => {\n      JSON.parse(activeField.value.fields).forEach(field => {\n        if (field.id === field_id) {\n          console.log(updatedField.value);\n          field.value = updatedField.value;\n          console.log(field.value);\n        }\n      });\n      console.log(JSON.parse(activeField.value.fields));\n    };\n    onMounted(() => {\n      try {\n        loading.value = true;\n        axios.get('/fields', {\n          headers: {\n            'Authorization': 'Bearer ' + localStorage.getItem('token')\n          }\n        }).then(response => response.data).then(response => {\n          apiData.value = response.fields;\n          loading.value = false;\n        }).catch(response => {\n          error.value = response;\n        });\n      } catch (e) {\n        error.value = e;\n      }\n    });\n    const __returned__ = {\n      props,\n      apiData,\n      loading,\n      error,\n      activeField,\n      selectedFieldId,\n      toggleTemplates,\n      selectedField,\n      hideToggleTemplates,\n      setFieldId,\n      updateField,\n      computed,\n      onMounted,\n      ref,\n      get axios() {\n        return axios;\n      },\n      get DisplayField() {\n        return DisplayField;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"mappings":"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","names":["computed","onMounted","ref","axios","DisplayField","apiData","loading","error","activeField","selectedFieldId","toggleTemplates","selectedField","value","primaryField","filter","field","is_primary","id","hideToggleTemplates","setFieldId","field_id","updateField","updatedField","JSON","parse","fields","forEach","console","log","get","headers","localStorage","getItem","then","response","data","catch","e"],"sources":["/Users/khaled.el-moussa/Desktop/Projekter/Kal2/frontend/src/components/NewTask/Fields/FieldsContainer.vue"],"sourcesContent":["<template>\n  <div class=\"bg-gray-50 relative max-h-[40vh] border border-gray-100 overflow-y-scroll rounded-md\" :class=\"{'h-[200px]': loading}\">\n    <Loader :loading=\"loading\"/>\n    <div v-if=\"selectedField\">\n      <div class=\"flex justify-center\">\n        <div class=\"mx-auto relative\">\n          <p class=\"font-inter text-[14px] text-gray-700 w-[200px] justify-center bg-gray-100 px-5 pt-1 pb-2 leading-none rounded-b-lg inline-flex text-center items-center hover-transition cursor-pointer hover:bg-gray-200\" @click=\"toggleTemplates = !toggleTemplates\">\n            {{ selectedField.title }}\n            <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"2\" stroke=\"currentColor\" class=\"w-4 mt-[1px] ml-1\">\n              <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M19.5 8.25l-7.5 7.5-7.5-7.5\" />\n            </svg>\n          </p>\n          <div class=\"absolute left-0 top-[35px] w-[200px] font-inter text-[14px] text-gray-700 z-20 bg-gray-100 rounded-md shadow-sm border border-gray-200\" v-if=\"toggleTemplates\" v-click-outside=\"hideToggleTemplates\">\n            <div class=\"p-1 text-center hover-transition hover:bg-gray-200 cursor-pointer border-b border-gray-200\" :class=\"{'bg-gray-400': field.id === selectedField.id}\" @click=\"setFieldId(field.id)\" v-for=\"(field, index) in apiData\">{{ field.title }}</div>\n          </div>\n        </div>\n      </div>\n      <div class=\"grid grid-cols-2 bg-gray-50 gap-x-5 gap-y-4 px-2 pb-4 mt-3\">\n        <div v-for=\"field in JSON.parse(selectedField.fields)\" :key=\"selectedField.id\" v-if=\"selectedField\">\n          <DisplayField :field=\"field\" @getField=\"updatedField => updateField(updatedField, field.id)\"/>\n        </div>\n      </div>\n    </div>\n    <div class=\"flex flex-col items-center justify-center py-8 text-gray-600 font-inter\" v-else>\n      <img src=\"@/assets/images/empty.png\" class=\"w-[100px]\" alt=\"Empty icon\"/>\n      <div class=\"text-[13.5px] mt-2 font-light\">Ingen skabeloner blev fundet</div>\n      <RouterLink to=\"/new/field\" class=\"bg-gray-700 text-white text-[13px] mt-3 px-5 py-2 rounded-md hover-transition hover:bg-gray-600\">Opret skabelon</RouterLink>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { computed, onMounted, ref } from \"vue\";\nimport axios from \"axios\";\nimport DisplayField from \"@/components/DisplayField\";\n\n  const props = defineProps({\n    jsonData: String\n  });\n\n  const apiData = ref();\n  const loading = ref();\n  const error = ref();\n  const activeField = ref();\n  const selectedFieldId = ref(null);\n  const toggleTemplates = ref();\n\n  const selectedField = computed(() => {\n    if (apiData.value) {\n      // If no selected field set the primary\n      if (selectedFieldId.value === null) {\n        const primaryField = apiData.value.filter(field => field.is_primary === 1)[0];\n        if (!primaryField) {\n          // If no primary, set the first one\n          activeField.value = apiData.value[0];\n          return apiData.value[0];\n        }\n\n        activeField.value = primaryField;\n        return primaryField;\n      } else {\n        // If selected field\n        activeField.value = apiData.value.filter(field => field.id === selectedFieldId.value)[0];\n        return apiData.value.filter(field => field.id === selectedFieldId.value)[0];\n      }\n    }\n  });\n\n  const hideToggleTemplates = () => {\n    if (toggleTemplates.value) {\n      toggleTemplates.value = false;\n    }\n  }\n\n  const setFieldId = (field_id) => {\n      selectedFieldId.value = field_id;\n      toggleTemplates.value = false; // Hide dropdown after selected\n  }\n\n  const updateField = (updatedField, field_id) => {\n    JSON.parse(activeField.value.fields).forEach(field => {\n      if (field.id === field_id) {\n        console.log(updatedField.value);\n        field.value = updatedField.value\n        console.log(field.value);\n      }\n    });\n\n    console.log(JSON.parse(activeField.value.fields));\n  }\n\n  onMounted(() => {\n    try {\n      loading.value = true;\n      axios.get('/fields', {\n        headers: {\n          'Authorization': 'Bearer '+ localStorage.getItem('token')\n        }\n      }).then((response) => response.data).then((response) => {\n        apiData.value = response.fields;\n        loading.value = false;\n      }).catch((response) => {\n        error.value = response;\n      });\n    } catch(e) {\n      error.value = e;\n    }\n  });\n</script>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}